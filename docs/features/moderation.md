# 모더레이션

서버를 관리하고 질서를 유지하기 위한 모더레이션 기능입니다.

## 개요

모더레이션 시스템은 서버 관리자와 모더레이터가 멤버를 관리하고, 규칙을 시행하며, 서버 질서를 유지할 수 있도록 돕습니다.

### 주요 기능
- ✅ 멤버 킥/밴 관리
- ✅ 임시 타임아웃
- ✅ 메시지 대량 삭제
- ✅ 경고 시스템
- ✅ 경고 기록 관리

## 명령어

### `/kick` - 멤버 추방
서버에서 멤버를 추방합니다. 추방된 멤버는 초대 링크를 통해 다시 참가할 수 있습니다.

**권한**: Kick Members
**매개변수**:
- `member` (필수): 추방할 멤버
- `reason` (선택): 추방 사유

**예시**:
```
/kick member:@사용자 reason:"규칙 위반"
/kick member:@사용자 reason:"스팸 행위"
```

### `/ban` - 멤버 차단
서버에서 멤버를 영구 차단합니다.

**권한**: Ban Members
**매개변수**:
- `member` (필수): 차단할 멤버
- `reason` (선택): 차단 사유
- `delete_messages` (선택): 삭제할 메시지 기간 (일, 0-7)

**예시**:
```
/ban member:@사용자 reason:"악의적 행동" delete_messages:7
/ban member:@사용자 reason:"지속적인 규칙 위반" delete_messages:1
```

### `/unban` - 차단 해제
차단된 사용자의 차단을 해제합니다.

**권한**: Ban Members
**매개변수**:
- `user_id` (필수): 차단 해제할 사용자 ID

**예시**:
```
/unban user_id:123456789012345678
```

> **팁**: 사용자 ID는 개발자 모드에서 확인할 수 있습니다.

### `/timeout` - 임시 타임아웃
멤버를 일시적으로 타임아웃합니다. 타임아웃된 멤버는 메시지를 보내거나 음성 채널에 참가할 수 없습니다.

**권한**: Moderate Members
**매개변수**:
- `member` (필수): 타임아웃할 멤버
- `minutes` (필수): 타임아웃 시간 (분, 1-40320)
- `reason` (선택): 타임아웃 사유

**예시**:
```
/timeout member:@사용자 minutes:60 reason:"경고"
/timeout member:@사용자 minutes:1440 reason:"1일 타임아웃"
```

### `/untimeout` - 타임아웃 해제
멤버의 타임아웃을 해제합니다.

**권한**: Moderate Members
**매개변수**:
- `member` (필수): 타임아웃 해제할 멤버

**예시**:
```
/untimeout member:@사용자
```

### `/clear` - 메시지 삭제
채널의 메시지를 대량 삭제합니다.

**권한**: Manage Messages
**매개변수**:
- `amount` (필수): 삭제할 메시지 수 (1-100)

**예시**:
```
/clear amount:50
/clear amount:100
```

> **주의**: 14일 이상 된 메시지는 삭제할 수 없습니다.

### `/warn` - 경고 부여
멤버에게 경고를 부여합니다.

**권한**: Moderate Members
**매개변수**:
- `member` (필수): 경고할 멤버
- `reason` (필수): 경고 사유

**예시**:
```
/warn member:@사용자 reason:"스팸"
/warn member:@사용자 reason:"부적절한 언어 사용"
```

### `/warnings` - 경고 목록
멤버의 경고 목록을 확인합니다.

**권한**: Moderate Members
**매개변수**:
- `member` (필수): 확인할 멤버

**예시**:
```
/warnings member:@사용자
```

### `/clearwarnings` - 경고 삭제
멤버의 모든 경고를 삭제합니다.

**권한**: Administrator
**매개변수**:
- `member` (필수): 경고를 삭제할 멤버

**예시**:
```
/clearwarnings member:@사용자
```

## 사용 시나리오

### 시나리오 1: 스팸 행위 대응
```
1. /clear amount:50        # 스팸 메시지 삭제
2. /warn member:@사용자 reason:"스팸 행위"
3. /timeout member:@사용자 minutes:60 reason:"1차 경고"
```

### 시나리오 2: 지속적인 규칙 위반
```
1. /warnings member:@사용자           # 경고 기록 확인
2. /timeout member:@사용자 minutes:1440 reason:"2차 경고"
3. /ban member:@사용자 reason:"3회 경고 누적"
```

### 시나리오 3: 채널 정리
```
/clear amount:100   # 최근 100개 메시지 삭제
```

## 경고 시스템

### 경고 작동 방식

1. **경고 부여**: `/warn` 명령어로 경고 부여
2. **자동 기록**: 모든 경고가 데이터베이스에 저장됨
3. **확인 가능**: `/warnings`로 누적 경고 확인
4. **DM 알림**: 경고 받은 멤버에게 DM으로 알림 전송

### 경고 기록 정보

각 경고에는 다음 정보가 포함됩니다:
- 경고 ID
- 경고 사유
- 경고 부여한 모더레이터
- 경고 부여 시간

### 권장 경고 단계

| 경고 횟수 | 조치 | 기간 |
|---------|------|-----|
| 1회 | 경고 + 주의 | - |
| 2회 | 경고 + 타임아웃 | 1시간 |
| 3회 | 경고 + 타임아웃 | 1일 |
| 4회+ | 영구 차단 | 영구 |

## 모범 사례

### ✅ 추천

1. **명확한 사유 기재**
   ```
   /warn member:@사용자 reason:"#일반 채널에서 광고 게시"
   ```

2. **단계적 조치**
   - 1차: 경고
   - 2차: 경고 + 짧은 타임아웃
   - 3차: 경고 + 긴 타임아웃
   - 4차: 차단

3. **증거 보관**
   - 스크린샷 저장
   - 메시지 링크 기록

4. **팀원과 소통**
   - 모더레이터 전용 채널에서 공유
   - 중요한 조치는 다른 모더레이터와 상의

### ❌ 피해야 할 것

1. **감정적 결정**
   - 개인적 감정으로 조치하지 않기

2. **일관성 없는 집행**
   - 같은 위반에 대해 다른 처벌

3. **과도한 처벌**
   - 경미한 위반에 즉시 차단

4. **사유 없는 조치**
   - 항상 명확한 사유 제공

## 권한 설정

### 필요한 권한

모더레이션 기능을 사용하려면 다음 권한이 필요합니다:

| 명령어 | 필요한 권한 |
|-------|-----------|
| `/kick` | Kick Members |
| `/ban`, `/unban` | Ban Members |
| `/timeout`, `/untimeout` | Moderate Members |
| `/clear` | Manage Messages |
| `/warn`, `/warnings` | Moderate Members |
| `/clearwarnings` | Administrator |

### 봇 권한 설정

봇에게도 다음 권한이 필요합니다:
- Kick Members
- Ban Members
- Moderate Members
- Manage Messages

## 문제 해결

### "권한이 없습니다" 오류

**원인**: 사용자 또는 봇에게 필요한 권한이 없음
**해결**:
1. 서버 설정 → 역할 → 권한 확인
2. 봇 역할이 대상 멤버보다 높은지 확인

### 메시지를 삭제할 수 없어요

**원인**: 14일 이상 된 메시지
**해결**: 최근 메시지만 삭제 가능

### 경고 DM이 전송되지 않아요

**원인**: 사용자가 DM을 차단함
**해결**: 정상 동작, 경고는 여전히 기록됨

## 로그 채널 설정 (선택사항)

모든 모더레이션 활동을 기록할 로그 채널을 설정할 수 있습니다.

`config.json`에서 설정:
```json
{
  "moderation": {
    "log_channel_id": "123456789012345678",
    "max_warnings": 3
  }
}
```

## 관련 기능

- [역할 관리](roles.md) - 역할 기반 권한 관리
- [유틸리티](utility.md) - 서버 및 사용자 정보 확인
